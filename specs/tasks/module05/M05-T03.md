# M05-T03: Define CoherenceConfig for Rolling Window Tracking

```yaml
task:
  id: "M05-T03"
  title: "Define CoherenceConfig for Rolling Window Tracking"
  description: |
    Implement CoherenceConfig struct for coherence tracking configuration.
    Fields: window_size (100), recency_decay (0.98), semantic_weight (0.6),
    structural_weight (0.4), default_coherence_empty (0.5),
    default_coherence_no_concepts (0.4).
    Include contradiction detection fields: contradiction_search_k (20),
    contradiction_similarity_threshold (0.85), max_contradiction_penalty (0.5).
  layer: "foundation"
  priority: "high"
  estimated_hours: 1.5
  file_path: "crates/context-graph-utl/src/config.rs"
  dependencies: []
  acceptance_criteria:
    - "CoherenceConfig struct with 9 fields"
    - "semantic_weight + structural_weight = 1.0"
    - "Default returns spec-defined values"
    - "Contradiction fields configured correctly"
  test_file: "crates/context-graph-utl/tests/config_tests.rs"
  spec_refs:
    - "TECH-UTL-005 Section 10"
    - "SPEC-UTL-005 Section 4.3"
```

---

## Description

Implement CoherenceConfig struct for coherence tracking configuration. Fields: window_size (100), recency_decay (0.98), semantic_weight (0.6), structural_weight (0.4), default_coherence_empty (0.5), default_coherence_no_concepts (0.4). Include contradiction detection fields: contradiction_search_k (20), contradiction_similarity_threshold (0.85), max_contradiction_penalty (0.5).

## Details

| Field | Value |
|-------|-------|
| **Layer** | foundation |
| **Priority** | high |
| **Estimated Hours** | 1.5 |
| **File Path** | `crates/context-graph-utl/src/config.rs` |

## Dependencies

None - this is a foundational configuration task.

## Configuration Fields

### CoherenceConfig

| Field | Type | Default Value | Description |
|-------|------|---------------|-------------|
| `window_size` | usize | 100 | Size of rolling window for coherence tracking |
| `recency_decay` | f32 | 0.98 | Decay factor for recency weighting |
| `semantic_weight` | f32 | 0.6 | Weight for semantic coherence |
| `structural_weight` | f32 | 0.4 | Weight for structural coherence |
| `default_coherence_empty` | f32 | 0.5 | Default coherence when window is empty |
| `default_coherence_no_concepts` | f32 | 0.4 | Default coherence with no concepts |
| `contradiction_search_k` | usize | 20 | Number of similar nodes to search for contradictions |
| `contradiction_similarity_threshold` | f32 | 0.85 | Similarity threshold for contradiction detection |
| `max_contradiction_penalty` | f32 | 0.5 | Maximum penalty for detected contradictions |

## Constraints

- `semantic_weight + structural_weight = 1.0`

## Acceptance Criteria

- [ ] CoherenceConfig struct with 9 fields
- [ ] semantic_weight + structural_weight = 1.0
- [ ] Default returns spec-defined values
- [ ] Contradiction fields configured correctly

## Test File

`crates/context-graph-utl/tests/config_tests.rs`

## Specification References

- TECH-UTL-005 Section 10
- SPEC-UTL-005 Section 4.3
